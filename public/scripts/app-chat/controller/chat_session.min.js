define(["util","eventemitter","app-chat/view/build/template"],function(s,t,i){function e(s,t){this.el=s,this.sessions=t}var n=s;return e.prototype={elements:{}},e=n.eventify(e,t),n.include(e,{init:function(){this._checkSession()?this._render():this.el.innerHTML="无记录",this._initDom(),this._initEvent()},_render:function(){var s=this._template();this.el.innerHTML=s},_template:function(){return i("chat-session",this.sessions.getSessionObj())},_initDom:function(){for(var s in this.elements)this[this.elements[s]]=n.$(s,this.el)},_initEvent:function(){n.delegate(this.el,"section","click",this.showChat.bind(this),{fn:function(s){return s.classList.contains("session-item")}}),this.on("addsession",this.updateSession.bind(this))},showChat:function(s,t){var i=t.getAttribute("data-sessionname"),e=n.$("section[data-chatname='"+i+"']");this._showDiv(e.parentElement)},_showDiv:function(s){s.classList.remove("mz")},updateSession:function(s){this._hasSession(s)||(this._updateSession(s),this._render())},_hasSession:function(s){return this.sessions.hasSession(s)},_updateSession:function(s){this.sessions.addSession(s)},_checkSession:function(){return!!this.sessions.getSession()}}),e});